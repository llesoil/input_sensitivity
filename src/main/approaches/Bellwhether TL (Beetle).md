### Beetle


> @article{beetle,
  author    = {Rahul Krishna and
               Vivek Nair and
               Pooyan Jamshidi and
               Tim Menzies},
  title     = {Whence to Learn? Transferring Knowledge in Configurable Systems using
               {BEETLE}},
  journal   = {CoRR},
  volume    = {abs/1911.01817},
  year      = {2019},
  url       = {http://arxiv.org/abs/1911.01817},
  archivePrefix = {arXiv},
  eprint    = {1911.01817},
  timestamp = {Mon, 11 Nov 2019 18:38:09 +0100},
  biburl    = {https://dblp.org/rec/journals/corr/abs-1911-01817.bib},
  bibsource = {dblp computer science bibliography, https://dblp.org}
}

**Beetle** is a transfer learning approach defined by Krishna et al that relies on *source selection*. 
Given a (set of) input(s), the goal is to rank the sources by performance, in order to discover a bellwether input from which we can easily transfer performances (i.e. find the best source). 
Then, we transfer performances from this bellwether input to all inputs of the test set. 
We only apply the discovery phase (i.e. the search of bellwether) on the training set, to avoid introducing any bias in the results. 

#### Libraries


```python
# for arrays
import numpy as np

# for dataframes
import pandas as pd

# plots
import matplotlib.pyplot as plt
# high-level plots
import seaborn as sns

# statistics
import scipy.stats as sc
# hierarchical clustering, clusters
from scipy.cluster.hierarchy import linkage, cut_tree, leaves_list
from scipy import stats
# statistical tests
from scipy.stats import mannwhitneyu

# machine learning library
# Principal Component Analysis - determine new axis for representing data
from sklearn.decomposition import PCA
# Random Forests -> vote between decision trees
# Gradient boosting -> instead of a vote, upgrade the same tree
from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier, GradientBoostingClassifier
# To add interactions in linear regressions models
from sklearn.preprocessing import PolynomialFeatures
# Elasticnet is an hybrid method between ridge and Lasso
from sklearn.linear_model import LinearRegression, ElasticNet
# To separate the data into training and test
from sklearn.model_selection import train_test_split, GridSearchCV
# Simple clustering (iterative steps)
from sklearn.cluster import KMeans
# Support vector machine - support vector regressor
from sklearn.svm import SVR
# decision trees
from sklearn.tree import DecisionTreeRegressor, plot_tree
# mean squared error
from sklearn.metrics import mean_squared_error

# gradient boosting trees
from xgboost import XGBRegressor

# we use it to interact with the file system
import os
# compute time
from time import time

# Neural network high level framework
import keras
# Sequential is a sequence of blocs
# Input deals with the data fed to the network
from keras.models import Sequential,Input,Model
# Dense is a feedforward layer with fully connected nodes
# Dropout allows to keep part of data, and to "drop out" a the rest
# Flatten makes the data "flat", i.e. in one dimension
from keras.layers import Dense, Dropout, Flatten
# Conv -> convolution, MaxPooling is relative to Pooling
# Activation if the function composing the data in output of a layer
from keras.layers import Conv2D, MaxPooling2D, Activation
```

    Using TensorFlow backend.



```python
class Beetle:
    
    def __init__(self):
        #self.pct_test = pct_test
        #self.ratio_exploitation = ratio_exploitation
        
        # the data folder, see the markdown there for additional explanations
        res_dir = "../../../data/ugc/res_ugc/"
        
        # the list of videos names, e.g. Animation_360P-3e40
        # we sort the list so we keep the same ids between two launches
        v_names = sorted(os.listdir(res_dir))

        self.predDimension = "kbs"
        
        # the list of measurements
        listVideo = []

        # we add each dataset in the list, converting the time to the right format
        # third line asserts that the measures are complete
        for v in v_names:
            data = pd.read_table(res_dir+v, delimiter = ',')
            inter = pd.get_dummies(data)
            inter[self.predDimension] = data[self.predDimension]
            listVideo.append(inter)
        
        self.listVideo = listVideo
        
        
        # to sample the source and the target using the same seed
        self.random_state = np.random.randint(0,1000)
        
        self.features = ['cabac', '8x8dct', 'mbtree', 'rc_lookahead', 'analyse', 'me', 'subme', 'mixed_ref', 'me_range', 
                 'qpmax', 'aq-mode', 'trellis','fast_pskip', 'chroma_qp_offset', 'bframes', 'b_pyramid', 
                 'b_adapt', 'direct', 'ref', 'deblock', 'weightb', 'open_gop', 'weightp', 'scenecut']
    
    def mse(self, y_true, y_pred):
        return np.mean((y_true-y_pred)**2)
         
    def find_bellwether(self, index_train):
        
        # GOAL : Find a good input source to transfer performances
        
        # first, we isolate the training set, and separate in two categories
        
        listInputs = [self.listVideo[i] for i in index_train]
        
        # on one side the sources,on the other side the targets
        sources_index, targets_index = train_test_split(index_train, test_size = 50)
        
        #sources = [self.listVideo[i] for i in sources_index]
        #targets = [self.listVideo[i] for i in targets_index]
        
        results_beetle = dict()
        
        # for these 50 target videos, we transfer the performances of all the sources
        # and keep the best source (i.e. the one leading to the best mse)
        # finally, the bellwether is the video of the training set that
        # give the best results for most of the target videos
        
        for index_t in targets_index:
            t = self.listVideo[index_t]
            X_tgt = t.drop([self.predDimension], axis = 1)
            y_tgt = np.array(t[self.predDimension], dtype=float)
            for index_s in sources_index:
                s = self.listVideo[index_s]
                X_src = s.drop([self.predDimension], axis = 1)
                y_src = np.array(s[self.predDimension], dtype=float)
                X_src_train, X_src_test, y_src_train, y_src_test = train_test_split(X_src, 
                                                                                y_src, 
                                                                                train_size=0.7)
                la = RandomForestRegressor()
                la.fit(X_src_train, y_src_train)
                y_tgt_pred = la.predict(X_src)
                results_beetle[(index_t, index_s)] = self.mse(y_tgt_pred, y_tgt)
            
        # We return the mean average percentage error 
        # between the real values of y_test from target 
        # and the predictions shifted 
        return results_beetle
    
    def learn(self, target_id, train_size, 
                    learning_algorithm = RandomForestRegressor):

        # random state , i.e. a seed to split the source and the target datasets
        # by using the same set of configurations for training and testing
        random_state = np.random.randint(0,1000)
        
        #print(X_src_train.shape)
        # We define the target video, and split it into train-test
        source = self.listVideo[459]
        X_src = source.drop([self.predDimension], axis = 1)
        y_src = np.array(source[self.predDimension], dtype=float)
        X_src_train, X_src_test, y_src_train, y_src_test = train_test_split(X_src, 
                                                                            y_src, 
                                                                            train_size=train_size, 
                                                                            random_state=random_state)
        
        lf = learning_algorithm()
        lf.fit(X_src_train, y_src_train)
        y_src_pred = np.array(lf.predict(X_src)).reshape(-1,1)
        
        target = self.listVideo[target_id]
        X_tgt = target.drop([self.predDimension], axis = 1)
        y_tgt = np.array(source[self.predDimension], dtype=float)

        # We return the mean average percentage error 
        # between the real values of y_test from target 
        # and the predictions shifted 

        # We return the mean average percentage error 
        # between the real values of y_test from target 
        # and the predictions shifted 
        return self.mse(y_src_pred, y_tgt)
    
    def predict_conf(self, target_id, train_size, 
                    learning_algorithm = RandomForestRegressor):

        # random state , i.e. a seed to split the source and the target datasets
        # by using the same set of configurations for training and testing
        random_state = np.random.randint(0,1000)
        
        #print(X_src_train.shape)
        # We define the target video, and split it into train-test
        source = self.listVideo[459]
        X_src = source.drop([self.predDimension], axis = 1)
        y_src = np.array(source[self.predDimension], dtype=float)
        X_src_train, X_src_test, y_src_train, y_src_test = train_test_split(X_src, 
                                                                            y_src, 
                                                                            train_size=train_size, 
                                                                            random_state=random_state)
        
        lf = learning_algorithm()
        lf.fit(X_src_train, y_src_train)
        y_src_pred_test = np.array(lf.predict(X_src)).reshape(-1,1)

        # We return the mean average percentage error 
        # between the real values of y_test from target 
        # and the predictions shifted 

        # We return the mean average percentage error 
        # between the real values of y_test from target 
        # and the predictions shifted 
        return np.argmin(y_src_pred_test)
```


```python
beetle = Beetle()
```


```python
# the data folder, see the markdown there for additional explanations
res_dir = "../../../data/ugc/res_ugc/"

# the list of videos names, e.g. Animation_360P-3e40
# we sort the list so we keep the same ids between two launches
v_names = sorted(os.listdir(res_dir)) 

v_names_train = np.loadtxt("../../../results/raw_data/train_names.csv", dtype= str)
v_names_test = np.loadtxt("../../../results/raw_data/test_names.csv", dtype= str)
index_train = [i for i in range(len(v_names)) if v_names[i] in v_names_train]
index_test = [i for i in range(len(v_names)) if v_names[i] in v_names_test]

train_sizes = np.arange(5,31,5)
```

#### Find a bellwhether input video

We search for a good source of transfer


```python
#results_mse_beetle = beetle.find_bellwether(index_train)
```


```python
results_mse_beetle
```




    {(1371, 261): 32026.72760816848,
     (1371, 287): 320050.5104023576,
     (1371, 249): 184835.74623490975,
     (1371, 377): 15753760.742637599,
     (1371, 426): 112675.15815496627,
     (1371, 505): 1165279.6897556633,
     (1371, 475): 23109363.877881587,
     (1371, 410): 272447.0251584397,
     (1371, 91): 36373210.61039268,
     (1371, 20): 7332512.447100236,
     (1371, 903): 2554117382.5365143,
     (1371, 560): 143496781.50428247,
     (1371, 114): 616175.9780099022,
     (1371, 895): 2518136802.4581437,
     (1371, 232): 538623710.4305638,
     (1371, 366): 739211.9410972204,
     (1371, 1074): 5324012.144146831,
     (1371, 1254): 597025161.1266451,
     (1371, 297): 207516174.06544486,
     (1371, 623): 18692919.73912521,
     (1371, 613): 1619704.7821560726,
     (1371, 1057): 580202.530028709,
     (1371, 1167): 124360112.41314265,
     (1371, 768): 124235677.97327493,
     (1371, 876): 83691369.62872286,
     (1371, 551): 1395049.9803319334,
     (1371, 160): 81833332.7864425,
     (1371, 387): 118942.20226204966,
     (1371, 950): 200709.285787804,
     (1371, 406): 87063.90583995797,
     (1371, 748): 1475843.011986341,
     (1371, 834): 237164.80047627402,
     (1371, 766): 137617967.48790666,
     (1371, 143): 933487.5967488621,
     (1371, 408): 1376242.972857805,
     (1371, 166): 110604250.84269749,
     (1371, 1028): 16981153.008387163,
     (1371, 1288): 5550732546.262963,
     (1371, 628): 4570378.575986233,
     (1371, 407): 1984776.6022341147,
     (1371, 1389): 23158172.369559076,
     (1371, 1014): 22758788.130210616,
     (1371, 1367): 139903204.21169978,
     (1371, 844): 556569.1428220381,
     (1371, 474): 103217524.91443934,
     (1371, 849): 4495713.463494208,
     (1371, 1016): 8411994.084597291,
     (1371, 1209): 67533064.04123679,
     (1371, 522): 182458.65370905658,
     (1371, 227): 385617717.0297424,
     (1371, 358): 611836991.8433888,
     (1371, 1000): 11709798.557505818,
     (1371, 512): 1404650.0181548055,
     (1371, 1051): 68581.32616425518,
     (1371, 326): 347800.577784118,
     (1371, 26): 491381.32666812127,
     (1371, 976): 91387596.35388051,
     (1371, 1243): 124096845.50995928,
     (1371, 203): 377382479.68553567,
     (1371, 558): 10864130.298575945,
     (1371, 1160): 10854192.777254116,
     (1371, 1052): 200708.3704994385,
     (1371, 508): 1087456.9778461265,
     (1371, 312): 10866540.8832556,
     (1371, 983): 1436699.6763009646,
     (1371, 663): 150736.65601928567,
     (1371, 1059): 332072.8727215431,
     (1371, 154): 334199060.0069973,
     (1371, 681): 11464190.158261985,
     (1371, 776): 21826718.539547555,
     (1371, 1230): 2296800.4019459,
     (1371, 1017): 189317519.10380083,
     (1371, 1126): 138517920.3378082,
     (1371, 251): 620269.9147579828,
     (1371, 878): 27084848.670030992,
     (1371, 1347): 109088.21991954905,
     (1371, 603): 12718842.655449357,
     (1371, 84): 4825156.39862819,
     (1371, 477): 1737422.505891792,
     (1371, 1236): 6247106.4454810675,
     (1371, 686): 105209.75449589279,
     (1371, 929): 169991.0590370662,
     (1371, 701): 11869580.809440551,
     (1371, 514): 311328.389395813,
     (1371, 1112): 190916101.94546333,
     (1371, 655): 1005719.1166725309,
     (1371, 293): 23625451.987973988,
     (1371, 453): 4975972.22583152,
     (1371, 1129): 6049039943.198851,
     (1371, 1394): 16495328.520805428,
     (1371, 31): 1847068.4220909316,
     (1371, 1140): 80178093.64343303,
     (1371, 95): 58204348.0925993,
     (1371, 703): 333980489.9857913,
     (1371, 390): 771927.7309246993,
     (1371, 676): 29666601.077891003,
     (1371, 1390): 14198082.19645084,
     (1371, 443): 14966420.279685969,
     (1371, 1037): 135030714.5750603,
     (1371, 1284): 298100228.87019676,
     (1371, 1066): 9672463.553535597,
     (1371, 99): 60390877.096440844,
     (1371, 214): 740121865.3800524,
     (1371, 352): 252472680.15287355,
     (1371, 764): 2252564.6468097563,
     (1371, 425): 1353453.6869884196,
     (1371, 446): 1550210.470696158,
     (1371, 429): 372721.1128502881,
     (1371, 1352): 3810695.940281504,
     (1371, 896): 89852430.53131703,
     (1371, 1046): 1827881.1543737815,
     (1371, 427): 7160412.608445042,
     (1371, 810): 156557.61778161582,
     (1371, 630): 628104811.4326365,
     (1371, 1231): 34052161.85281888,
     (1371, 361): 289673433.117943,
     (1371, 732): 259776.3199166058,
     (1371, 549): 7073055.694281484,
     (1371, 497): 659612.8393854183,
     (1371, 1376): 27602927.44862346,
     (1371, 1043): 53998.18404980417,
     (1371, 273): 3984259.398185563,
     (1371, 170): 1114685478.0934842,
     (1371, 1273): 656052236.4550899,
     (1371, 787): 668495.2028504373,
     (1371, 369): 82524086.21170951,
     (1371, 635): 85978606.91951254,
     (1371, 860): 19282919.71401131,
     (1371, 418): 9188891.685710698,
     (1371, 495): 626896.3797754472,
     (1371, 1396): 12927893.04077517,
     (1371, 64): 33896694.332303755,
     (1371, 1015): 8442578.965500437,
     (1371, 1253): 33500414.55489889,
     (1371, 1089): 110547398.20852779,
     (1371, 856): 20524285.818481166,
     (1371, 217): 707425459.0096654,
     (1371, 552): 9876105.250696484,
     (1371, 816): 248184.2704243243,
     (1371, 1050): 928639.3050399174,
     (1371, 935): 38364.85611409061,
     (1371, 587): 517484.26258427586,
     (1371, 1342): 1375946.9127780618,
     (1371, 706): 99810952.25601538,
     (1371, 1084): 135148221.31094247,
     (1371, 559): 46039255.85794558,
     (1371, 1086): 71841354.13470367,
     (1371, 773): 115132807.00466307,
     (1371, 29): 822053.3662659947,
     (1371, 644): 9770608.106448678,
     (1371, 851): 50152308.95821193,
     (1371, 583): 352155.1210688872,
     (1371, 1221): 1807219.6098430844,
     (1371, 541): 2186044.170988383,
     (1371, 1173): 59401804.32935189,
     (1371, 274): 650088.7570593733,
     (1371, 388): 30311.474169043733,
     (1371, 1168): 11815357.066994647,
     (1371, 831): 140933.28052949675,
     (1371, 395): 1838133.1035720664,
     (1371, 617): 60160400.06980175,
     (1371, 349): 110094574.84268701,
     (1371, 1206): 3834704.789357745,
     (1371, 945): 736525.6971350876,
     (1371, 1313): 3916999730.0257792,
     (1371, 1035): 6808117.952812692,
     (1371, 906): 220838881.3103127,
     (1371, 56): 11236346.151670687,
     (1371, 1384): 87649577.58493368,
     (1371, 245): 1043307.8458770947,
     (1371, 898): 1564439252.6228516,
     (1371, 966): 17001097.076005854,
     (1371, 1177): 111077264.34067623,
     (1371, 946): 10141223.271079112,
     (1371, 19): 237581.55706997,
     (1371, 1393): 19210307.974542655,
     (1371, 419): 1725889.2817820238,
     (1371, 1183): 9552320.515836246,
     (1371, 234): 1274073.3625026846,
     (1371, 178): 4501571478.098677,
     (1371, 599): 182517.7670136979,
     (1371, 1218): 1382074.165488654,
     (1371, 1358): 1033401.3502238918,
     (1371, 1377): 87700984.54454207,
     (1371, 290): 3309145.2401497876,
     (1371, 1364): 32819273.07838934,
     (1371, 403): 1556953.1552752724,
     (1371, 464): 406762.60414106573,
     (1371, 534): 4948640.805145941,
     (1371, 1085): 153464773.34351727,
     (1371, 695): 288521890.99753743,
     (1371, 988): 366492887.50763613,
     (1371, 308): 81203290.29398096,
     (1371, 144): 110447.93576462372,
     (1371, 1228): 12380126.983778417,
     (1371, 460): 253810845.563271,
     (1371, 633): 17946612.916506417,
     (1371, 1275): 185782035.2013168,
     (1371, 52): 989657.3272598907,
     (1371, 1305): 1202690735.2311182,
     (1371, 1311): 1606000090.4623613,
     (1371, 1226): 7503598.554656119,
     (1371, 636): 473879.8186328577,
     (1371, 264): 17946363.410341438,
     (1371, 735): 73134.87213424998,
     (1371, 1259): 153129636.79642645,
     (1371, 158): 42468306.805161364,
     (1371, 209): 1869326113.0651066,
     (1371, 780): 4403937.161553902,
     (1371, 23): 6825024942.0164385,
     (1371, 439): 653664.5173342585,
     (1371, 640): 698890.2639511571,
     (1371, 1005): 202074339.5393016,
     (1371, 1102): 29812258.61730849,
     (1371, 283): 2184521.024684597,
     (1371, 445): 91756190.38622381,
     (1371, 827): 138075.83320943505,
     (1371, 526): 108385.61573976954,
     (1371, 69): 458388.5868052692,
     (1371, 1279): 107230395.62174213,
     (1371, 1242): 547629216.767777,
     (1371, 10): 6457830.669758671,
     (1371, 1073): 191906.9266119681,
     (1371, 1289): 2205635795.689664,
     (1371, 327): 132232.8633956993,
     (1371, 1067): 56693047.68092302,
     (1371, 562): 128824598.86740357,
     (1371, 1330): 1135200.5383502045,
     (1371, 259): 78953.5254816266,
     (1371, 618): 16549891.635003781,
     (1371, 250): 440713.53230349877,
     (1371, 45): 877327.1375287165,
     (1371, 1222): 118344492.5924344,
     (1371, 711): 252299442.0875585,
     (1371, 42): 245208.867347719,
     (1371, 654): 1506893.5223745345,
     (1371, 324): 173945242.30615425,
     (1371, 82): 216695494.89778122,
     (1371, 67): 460823.21859392256,
     (1371, 970): 11140979.55318279,
     (1371, 892): 260834879.73353463,
     (1371, 1235): 155601725.14239955,
     (1371, 1132): 3371513670.610082,
     (1371, 837): 1158410.131859673,
     (1371, 260): 197289.91017840806,
     (1371, 875): 9322023.491857005,
     (1371, 1063): 4461212.21486405,
     (1371, 1088): 47354228.15741531,
     (1371, 775): 119554713.14632706,
     (1371, 863): 278986.83553699445,
     (1371, 680): 283589.4508142761,
     (1371, 1039): 92884.02845542837,
     (1371, 565): 3600400.1183358477,
     (1371, 923): 135059343.85596853,
     (1371, 799): 173101.68736688426,
     (1371, 535): 28553617.753599092,
     (1371, 540): 1581271.4337983774,
     (1371, 1077): 195282371.77304563,
     (1371, 1061): 755150.6490842476,
     (1371, 482): 947544.7036666763,
     (1371, 71): 10344680.083134724,
     (1371, 651): 441635.32513755694,
     (1371, 268): 3881523.0108937933,
     (1371, 1006): 5998498.386852517,
     (1371, 1181): 5987719.407628256,
     (1371, 68): 1984538.3613020887,
     (1371, 322): 18752731.27871498,
     (1371, 1075): 172661605.35557705,
     (1371, 798): 310732.5724924045,
     (1371, 391): 427844.5171400403,
     (1371, 1155): 5174077.922503341,
     (1371, 430): 1453140.5145771906,
     (1371, 140): 258945.0777530155,
     (1371, 1093): 419413068.6641419,
     (1371, 821): 253172.35130292756,
     (1371, 807): 198413.68081733843,
     (1371, 92): 85220954.63034704,
     (1371, 900): 586597316.8927698,
     (1371, 1378): 40800861.04901842,
     (1371, 1165): 128396677.68701267,
     (1371, 1147): 1686169.379163188,
     (1371, 77): 114542.56104203427,
     (1371, 316): 13184192.963632287,
     (1371, 1100): 8230171.054306274,
     (1371, 982): 297625.0283598972,
     (1371, 389): 1327399.4882501985,
     (1371, 1271): 4639647.819126537,
     (1371, 188): 294925467.91540945,
     (1371, 577): 403483768.38262224,
     (1371, 975): 4680618.015311036,
     (1371, 157): 21521611.994622216,
     (1371, 796): 70145.35424722316,
     (1371, 467): 8447076.555878598,
     (1371, 1031): 43695411.689419456,
     (1371, 917): 529332249.75990987,
     (1371, 25): 135315.44335038651,
     (1371, 470): 239575280.93964124,
     (1371, 658): 23138144.69829137,
     (1371, 999): 6525451.026633548,
     (1371, 503): 2993840.0906836363,
     (1371, 1270): 131106541.7419163,
     (1371, 520): 182706.96104996448,
     (1371, 1237): 9403362.887856754,
     (1371, 376): 17516325.46731569,
     (1371, 120): 384944.14200537466,
     (1371, 1099): 364547911.4593614,
     (1371, 32): 90686.36433478995,
     (1371, 337): 15914145.883444283,
     (1371, 414): 1810969.9647217104,
     (1371, 131): 14931596.716816163,
     (1371, 673): 6928707.648160675,
     (1371, 909): 1569638105.989873,
     (1371, 101): 42982730.66173075,
     (1371, 1380): 853550.4934784842,
     (1371, 936): 179706.0900222143,
     (1371, 718): 64514.93902127106,
     (1371, 38): 52899.71312797605,
     (1371, 792): 1348032.9712405186,
     (1371, 1207): 376675.9032862013,
     (1371, 360): 604205688.3990439,
     (1371, 610): 708155.4091291014,
     (1371, 957): 597942.5399481417,
     (1371, 139): 1370504.5899342592,
     (1371, 289): 75846863.84023908,
     (1371, 740): 461263.0898548604,
     (1371, 243): 17410.14598329385,
     (1371, 461): 29508089.038709257,
     (1371, 832): 4095816.123717529,
     (1371, 1258): 3607062375.0193205,
     (1371, 554): 179445.35207197702,
     (1371, 614): 8205342.322205646,
     (1371, 501): 420213.36332426826,
     (1371, 1012): 11443184.36823367,
     (1371, 1387): 40413996.78647558,
     (1371, 229): 275138272.378109,
     (1371, 582): 658480.879920254,
     (1371, 152): 24109836.381070435,
     (1371, 661): 781358.826824947,
     (1371, 192): 199755728.38285258,
     (1371, 932): 283470.9326858777,
     (1371, 454): 2004127.9750422887,
     (1371, 919): 784501975.2023331,
     (1371, 597): 271119.2754919424,
     (1371, 492): 1753505.9563177587,
     (1371, 175): 817968862.1956565,
     (1371, 853): 1868414.8128546928,
     (1371, 611): 91661.28672784149,
     (1371, 108): 118425460.30763176,
     (1371, 1293): 2034964451.5535703,
     (1371, 1149): 1952166.5392761407,
     (1371, 212): 2223453773.0186687,
     (1371, 778): 26596579.352094043,
     (1371, 679): 94448.30100207381,
     (1371, 1278): 324120291.5161601,
     (1371, 736): 201183.37072425731,
     (1371, 591): 781850.6378425512,
     (1371, 638): 1133349.605468955,
     (1371, 745): 1606552.6202654156,
     (1371, 1179): 456054310.01983756,
     (1371, 1245): 595202833.9167867,
     (1371, 1083): 25821343.958126966,
     (1371, 104): 5187745.537485745,
     (1371, 484): 262367.66524896224,
     (1371, 278): 362814.47693967976,
     (1371, 404): 113597.9523359179,
     (1371, 693): 199932828.11497763,
     (1371, 199): 136186820.93837276,
     (1371, 220): 720860069.81244,
     (1371, 1058): 526007.436893151,
     (1371, 256): 193543.81444120302,
     (1371, 1090): 125098811.12598969,
     (1371, 344): 417096609.1652726,
     (1371, 14): 63974691.178766966,
     (1371, 365): 10740107.552402187,
     (1371, 432): 29894943.42752001,
     (1371, 677): 1030732.008065526,
     (1371, 830): 228896.2027755542,
     (1371, 852): 10064644.54357544,
     (1371, 1146): 15860620.677927818,
     (1371, 782): 129495555.46911724,
     (1371, 1304): 647851819.2243233,
     (1371, 1111): 2490613372.2808995,
     (1371, 333): 74376715.36885877,
     (1371, 124): 784131.4272552438,
     (1371, 794): 202652.07972403354,
     (1371, 694): 33991014.68733237,
     (1371, 880): 39574305.498893805,
     (1371, 1047): 5207227.144292521,
     (1371, 37): 1769161.1879355754,
     (1371, 566): 39003960.2253632,
     (1371, 285): 862641.3672174349,
     (1371, 584): 40400.789657907844,
     (1371, 671): 521517.4255428452,
     (1371, 485): 610954.6994319776,
     (1371, 1053): 369269.80867386615,
     (1371, 1223): 10342678.693932567,
     (1371, 588): 267206.93330695893,
     (1371, 1041): 204169.42720089233,
     (1371, 595): 69879.20774681195,
     (1371, 468): 604988.062450945,
     (1371, 579): 333188.2099833462,
     (1371, 861): 1739128.024045942,
     (1371, 300): 88228996.66965048,
     (1371, 756): 822505.1857115648,
     (1371, 601): 690695.4761223277,
     (1371, 239): 203770.74434372087,
     (1371, 653): 1742201.3461989565,
     (1371, 279): 125052.43456491346,
     (1371, 368): 938282.8730588647,
     (1371, 1002): 45129132.6075522,
     (1371, 506): 122940.51823295212,
     (1371, 842): 71832.16908918144,
     (1371, 572): 134781389.97210997,
     (1371, 1323): 1396376114.236446,
     (1371, 1033): 5124874.428890969,
     (1371, 926): 3081790895.3869724,
     (1371, 282): 286477.1107553122,
     (1371, 1348): 2637762.0174733438,
     (1371, 496): 537305.1519935376,
     (1371, 258): 112461.6821010066,
     (1371, 332): 22790557.68479612,
     (1371, 992): 8310426.261911167,
     (1371, 0): 1617510.9534364115,
     (1371, 222): 193448106.75124666,
     (1371, 918): 1691364803.6596184,
     (1371, 194): 821219805.461654,
     (1371, 246): 875523.0865039275,
     (1371, 1325): 1851477271.4558015,
     (1371, 604): 707486.6126441754,
     (1371, 338): 2287877092.573545,
     (1371, 956): 3390441.94313786,
     (1371, 763): 39040634.96200136,
     (1371, 1038): 1131307.7154491283,
     (1371, 835): 1063217.604491776,
     (1371, 953): 371877.4891372239,
     (1371, 592): 241487.3913132449,
     (1371, 213): 1272533352.5269403,
     (1371, 744): 3143778.7558547435,
     (1371, 416): 726285.245715051,
     (1371, 843): 4917218.720120926,
     (1371, 1101): 72741484.78307751,
     (1371, 1164): 147781345.23395848,
     (1371, 598): 342081.45949767367,
     (1371, 1191): 4479122.857849902,
     (1371, 254): 390875.51539475477,
     (1371, 218): 1394201132.2568395,
     (1371, 608): 320356.4018970615,
     (1371, 342): 44157070.7972452,
     (1371, 869): 13877066.040396592,
     (1371, 665): 358285.1971958861,
     (1371, 838): 65404905.085953236,
     (1371, 1240): 216661661.88223517,
     (1371, 1255): 1354509322.5822082,
     (1371, 1010): 235300.47719784782,
     (1371, 1001): 91165.0964464959,
     (1371, 513): 2799478.0708120945,
     (1371, 1049): 220935.43662515786,
     (1371, 997): 30097613.180169817,
     (1371, 770): 15678250.737086805,
     (1371, 607): 214888.27134804885,
     (1371, 862): 58607.195680862096,
     (1371, 873): 261664779.36871848,
     (1371, 949): 415523.09575406235,
     (1371, 710): 1796793.02200732,
     (1371, 277): 28484180.567811918,
     (1371, 972): 4383007.43029724,
     (1371, 1268): 74156592.72825636,
     (1371, 751): 137440783.61885843,
     (1371, 449): 657279.4976048891,
     (1371, 1138): 1325162188.0645013,
     (1371, 1308): 825512901.11483,
     (1371, 80): 74892740.69731568,
     (1371, 521): 423994.55660385033,
     (1371, 12): 10829367.09551491,
     (1371, 1194): 114035.36565565821,
     (1371, 386): 403545.84525469615,
     (1371, 1372): 60758531.78050397,
     (1371, 1032): 5348799.790940982,
     (1371, 1003): 83041038.06646936,
     (1371, 747): 1187335.19777192,
     (1371, 466): 73249547.02177179,
     (1371, 455): 976668.7409206688,
     (1371, 1156): 248753669.1616677,
     (1371, 753): 464395.41943190433,
     (1371, 1298): 1172501650.611519,
     (1371, 688): 15006445.481989065,
     (1371, 1299): 1923310878.0259151,
     (1371, 346): 447396743.7058932,
     (1371, 1044): 179602.39243621493,
     (1371, 995): 48069609.58552318,
     (1371, 448): 43650498.019751005,
     (1371, 415): 4797604.569289191,
     (1371, 195): 416906342.84982616,
     (1371, 138): 87935.75756999828,
     (1371, 107): 1973863.415291786,
     (1371, 156): 477145654.9199581,
     (1371, 915): 5151378195.030916,
     (1371, 483): 1104000.2618112997,
     (1371, 683): 168136.7775200718,
     (1371, 939): 4100499.6391265523,
     (1371, 488): 831023.1341074273,
     (1371, 98): 89288697.54670347,
     (1371, 669): 25639437.98567194,
     (1371, 1227): 10935634.21405202,
     (1371, 743): 940084.8989575125,
     (1371, 733): 167862.16877368797,
     (1371, 481): 825697.6084691975,
     (1371, 126): 75131.39076055317,
     (1371, 879): 30712623.841436766,
     (1371, 280): 1046550.7378839931,
     (1371, 958): 1827594.4243394723,
     (1371, 374): 56800974.00562138,
     (1371, 204): 119958103.01695362,
     (1371, 645): 274921176.9871499,
     (1371, 657): 1803731.2433466406,
     (1371, 1019): 512131782.96177804,
     (1371, 350): 31869328.83254707,
     (1371, 908): 3960153055.334592,
     (1371, 301): 71295843.8963726,
     (1371, 18): 29949719.183953453,
     (1371, 881): 604310903.5969651,
     (1371, 272): 163410.47886974577,
     (1371, 417): 144639.84755131288,
     (1371, 1094): 688695056.7634183,
     (1371, 667): 1144122.1401449435,
     (1371, 162): 118140.19310687024,
     (1371, 117): 149955.06058670653,
     (1371, 303): 13648608.101358693,
     (1371, 93): 530289.5918265271,
     (1371, 1065): 730368.0676485028,
     (1371, 355): 234496737.31236124,
     (1371, 50): 1135845.6067103005,
     (1371, 233): 923050653.6680449,
     (1371, 1106): 20490700.032613996,
     (1371, 1359): 53598.144419030934,
     (1371, 1300): 2004771158.3615313,
     (1371, 1026): 7909853.155386218,
     (1371, 1212): 393390195.8642569,
     (1371, 223): 437151166.5036615,
     (1371, 1175): 48192674.96207112,
     (1371, 39): 21543.371107117677,
     (1371, 304): 4684643.692706178,
     (1371, 55): 1143192.614019905,
     (1371, 517): 33466.77890730069,
     (1371, 824): 842157.8910548026,
     (1371, 371): 2644428.380791298,
     (1371, 442): 11998543.414114544,
     (1371, 928): 5213031542.9795885,
     (1371, 921): 3503729198.968424,
     (1371, 891): 819282366.5710262,
     (1371, 994): 44547445.11583303,
     (1371, 110): 352045.77875533747,
     (1371, 933): 76464.182186873,
     (1371, 357): 1229381520.9461646,
     (1371, 1048): 426356.6465544341,
     (1371, 13): 151361410.4153589,
     (1371, 1108): 242551239.69390255,
     (1371, 530): 1096247.0395830558,
     (1371, 1370): 526381.2586106107,
     (1371, 859): 1868827.0595976897,
     (1371, 1027): 157771896.80533448,
     (1371, 267): 12781269.90291137,
     (1371, 253): 195826.1220695742,
     (1371, 1198): 1720931.9177227402,
     (1371, 1190): 334773.1750389444,
     (1371, 62): 673455.8305318693,
     (1371, 886): 1143154618.0898767,
     (1371, 1263): 1013393963.157478,
     (1371, 382): 1612262.8535466949,
     (1371, 347): 853771347.4376221,
     (1371, 263): 57981019.645709544,
     (1371, 884): 10044068.985930715,
     (1371, 1120): 5136592157.126692,
     (1371, 536): 502950.1049896719,
     (1371, 115): 43058.86946228464,
     (1371, 1131): 1597349131.2544653,
     (1371, 1045): 4452887.019418868,
     (1371, 65): 13234905.960198289,
     (1371, 606): 18330547.617403794,
     (1371, 678): 1810244.4270625222,
     (1371, 393): 1598425.2936719675,
     (1371, 985): 1097461.27907408,
     (1371, 351): 3018363996.9550476,
     (1371, 116): 660997.9655649714,
     (1371, 79): 2347770.922433132,
     (1371, 1203): 48305424.70972986,
     (1371, 519): 1865710.9940945217,
     (1371, 1301): 186068005.55605668,
     (1371, 402): 101928.89722369623,
     (1371, 473): 1853361.3098162129,
     (1371, 183): 19594560.38556644,
     (1371, 978): 91762323.34555484,
     (1371, 428): 2106139.0173599627,
     (1371, 885): 719355610.9229943,
     (1371, 652): 863231.6472722375,
     (1371, 656): 1520894.4967650182,
     (1371, 1153): 2843378.919452541,
     (1371, 741): 37012672.33450629,
     (1371, 1199): 176428.90857936107,
     (1371, 1341): 319703.64294089976,
     (1371, 805): 43372.73195650923,
     (1371, 912): 4480803681.949548,
     (1371, 626): 592189.5610032378,
     (1371, 405): 2065373.000247956,
     (1371, 364): 2767781494.763251,
     (1371, 847): 8269160.885144718,
     (1371, 434): 10154345.473942388,
     (1371, 1355): 227539.91213587916,
     (1371, 136): 1168644.8571092514,
     (1371, 244): 378459.69788429036,
     (1371, 922): 382806675.62193245,
     (1371, 1306): 1083659237.3473098,
     (1371, 134): 231888.3950234811,
     (1371, 585): 209272.2368113893,
     (1371, 737): 168466.25506057928,
     (1371, 1134): 34910477.5656489,
     (1371, 848): 28657490.851224124,
     (1371, 544): 3112198.505037037,
     (1371, 35): 283069.9126567019,
     (1371, 593): 29253.88913541519,
     (1371, 755): 14616690.764625365,
     (1371, 113): 344770.37267880206,
     (1371, 1133): 1243931745.1145349,
     (1371, 788): 435301.25580577116,
     (1371, 385): 758900.8389230999,
     (1371, 1334): 873305.4525444959,
     (1371, 328): 267192745.14289674,
     (1371, 1192): 3907415.0881970986,
     (1371, 1068): 506209.5642217389,
     (1371, 1105): 343656728.4439639,
     (1371, 1196): 137299.45353428708,
     (1371, 257): 124413.02254577301,
     (1371, 1124): 131844037.44810171,
     (1371, 172): 39372970.25657759,
     (1371, 372): 18849377.473977443,
     (1371, 1036): 336833172.413122,
     (1371, 9): 160048546.83442402,
     (1371, 727): 39785.809034642334,
     (1371, 185): 231402566.35632944,
     (1371, 731): 451862.4055665032,
     (1371, 934): 952925.2485821932,
     (1371, 1337): 182265.8634743082,
     (1371, 1110): 5809506937.129001,
     (1371, 1069): 8874743.636513017,
     (1371, 255): 918370.3993122969,
     (1371, 963): 2083214.2254570806,
     (1371, 902): 530214507.44149595,
     (1371, 284): 741418.7165088928,
     (1371, 511): 1507740.6077528053,
     (1371, 121): 737275.4972403371,
     (1371, 1343): 283256.7688226245,
     (1371, 818): 207695.46896241067,
     (1371, 942): 389413.1628759749,
     (1371, 362): 341357241.11762714,
     (1371, 580): 20461.40658486849,
     (1371, 712): 35913136.71686378,
     (1371, 1204): 65888.28815367528,
     (1371, 1257): 390532150.34886086,
     (1371, 1144): 285885279.4294109,
     (1371, 1174): 47012088.2199297,
     (1371, 836): 6693422.291099131,
     (1371, 576): 154539450.3507305,
     (1371, 319): 21001512.460094683,
     (1371, 993): 17043293.830939364,
     (1371, 700): 156182827.45163924,
     (1371, 660): 12866125.684374928,
     (1371, 83): 59839716.29251099,
     (1371, 315): 198703.87945222628,
     (1371, 1316): 2500661806.2253027,
     (1371, 1327): 94954089.56674217,
     (1371, 518): 92703.12558877964,
     (1371, 777): 67987115.12760007,
     (1371, 981): 1149423.761508464,
     (1371, 370): 166994892.624798,
     (1371, 1213): 33166.35746606275,
     (1371, 164): 142228.2153718738,
     (1371, 180): 65623647.04051681,
     (1371, 724): 156504.1466332014,
     (1371, 1277): 192241802.2695998,
     (1371, 100): 105841814.3804256,
     (1371, 379): 40334142.27701876,
     (1371, 947): 166194.18965481868,
     (1371, 133): 258781.65498984267,
     (1371, 1141): 14334375287.557938,
     (1371, 979): 130615.69267619464,
     (1371, 74): 5159917.067415515,
     (1371, 705): 50008349.42338209,
     (1371, 1285): 6231353812.529784,
     (1371, 1368): 15357623.371904472,
     (1371, 883): 25745713.87397405,
     (1371, 1335): 8066291.255206905,
     (1371, 664): 1487016.8228137416,
     (1371, 1054): 2446728.0055087246,
     (1371, 574): 20824893.470101755,
     (1371, 208): 1209424707.8297217,
     (1371, 137): 2345443.4398224372,
     (1371, 627): 121394.30626856902,
     (1371, 252): 2085476.8972969523,
     (1371, 730): 65567.56101749501,
     (1371, 184): 109860507.40896863,
     (1371, 825): 140340.70057689614,
     (1371, 205): 471184494.97798526,
     (1371, 27): 479940.0968535301,
     (1371, 1018): 57394753.83110775,
     (1371, 1103): 223400448.98653552,
     (1371, 323): 54456827.382416874,
     (1371, 112): 848426.0900191594,
     (1371, 772): 57060948.40867237,
     (1371, 353): 1864469174.1141932,
     (1371, 524): 219477.8842991016,
     (1371, 991): 84246542.6083359,
     (1371, 1170): 1332780828.6957023,
     (1371, 3): 177112294.26691574,
     (1371, 1260): 18599753.47891998,
     (1371, 581): 248126.10783273197,
     (1371, 650): 2715901.6353662037,
     (1371, 230): 125635290.67508179,
     (1371, 1256): 104121042.17552967,
     (1371, 1081): 171305717.2195846,
     (1371, 127): 159322.35303669225,
     (1371, 624): 12647533.789371531,
     (1371, 561): 211810903.29077953,
     (1371, 555): 818357.004556634,
     (1371, 1139): 2618242030.857346,
     (1371, 490): 1002371.6224514635,
     (1371, 570): 160108566.82974637,
     (1371, 397): 780605.7905995739,
     (1371, 486): 1533472.8626234164,
     (1371, 237): 864220.6304915601,
     (1371, 493): 591657.9178294404,
     (1371, 1215): 86257.62376802205,
     (1371, 231): 1128495104.6750126,
     (1371, 294): 5021915.7046157885,
     (1371, 1261): 235261868.97887474,
     (1371, 311): 6297413.859205427,
     (1371, 34): 141738.05333886264,
     (1371, 989): 191196.9717433528,
     (1371, 1176): 310643906.3253023,
     (1371, 866): 248027315.56790912,
     (1371, 1178): 72119032.32914096,
     (1371, 189): 441292048.5159798,
     (1371, 507): 1006558.0634590423,
     (1371, 378): 806727.7715797162,
     (1371, 1219): 53021350.45666179,
     (1371, 659): 1453611.2470238141,
     (1371, 1360): 943114.3885314221,
     (1371, 1353): 1748705.9703584618,
     (1371, 103): 28171683.08000769,
     (1371, 380): 101504889.57168792,
     (1371, 1356): 5838395.348410797,
     (1371, 240): 309345.95734998357,
     (1371, 729): 1068162.330602748,
     (1371, 769): 60491177.5869065,
     (1371, 187): 264151014.63630852,
     (1371, 438): 143819.90236022204,
     (1371, 1182): 326977028.8459312,
     (1371, 150): 387934.9654495536,
     (1371, 441): 148638606.23716846,
     (1371, 472): 12268019.006989792,
     (1371, 550): 897384.1523377834,
     (1371, 1158): 4246739.229081036,
     (1371, 2): 32632466.395637788,
     (1371, 168): 3317983.4395922488,
     (1371, 1349): 1431447.2606111388,
     (1371, 1150): 30611353.945035715,
     (1371, 504): 1719145.5867975994,
     (1371, 1339): 513665.60323260917,
     (1371, 546): 7284073.794997255,
     (1371, 759): 4828979.239699235,
     (1371, 1201): 4381624.286635328,
     (1371, 335): 17167578.99769323,
     (1371, 829): 116636.99051541889,
     (1371, 281): 523793.26992107474,
     (1371, 1115): 130607968.39815776,
     (1371, 1297): 523047703.50064784,
     (1371, 525): 322016.04529812717,
     (1371, 1200): 208828.18235195987,
     (1371, 954): 4221707.955669685,
     (1371, 545): 310447.14303498797,
     (1371, 803): 103574.45725346038,
     (1371, 471): 60464411.77900643,
     (1371, 1310): 4530895079.289689,
     (1371, 625): 11684254.729609914,
     (1371, 1244): 488748991.2336117,
     (1371, 1189): 408272.6513383261,
     (1371, 299): 4944858.579043892,
     (1371, 276): 5269579.788633626,
     (1371, 925): 5411043443.348682,
     (1371, 760): 5868065.547129491,
     (1371, 1248): 21798479.337451138,
     (1371, 726): 701489.9524498717,
     (1371, 1233): 31900152.631993383,
     (1371, 247): 282753.9813373941,
     (1371, 746): 19571526.542676646,
     (1371, 955): 38685729.29534477,
     (1371, 600): 1874853.6549196518,
     (1371, 1023): 7601578.790405274,
     (1371, 1361): 44594161.78065103,
     (1371, 786): 141530.15977927812,
     (1371, 977): 64862016.72698802,
     (1371, 1184): 1233932538.9179058,
     (1371, 1130): 1620199903.8663015,
     (1371, 553): 143324.62586621995,
     (1371, 298): 37950588.94587545,
     (1371, 964): 4194212.9344298886,
     (1371, 182): 32584272.374220334,
     (1371, 1251): 93406905.09975754,
     (1371, 167): 648418.3332759364,
     (1371, 1296): 78285956.2385107,
     (1371, 296): 6405359.014885786,
     (1371, 109): 950754.3664086593,
     (1371, 910): 1431798384.041042,
     (1371, 191): 1874324.6963130087,
     (1371, 1232): 411737.4212870774,
     (1371, 1166): 7134552.153079145,
     (1371, 571): 119838.73911188776,
     (1371, 478): 871326.8880047738,
     (1371, 1286): 569372138.9953043,
     (1371, 96): 157102083.38586935,
     (1371, 920): 3158421763.9074793,
     (1371, 1034): 21293066.042190567,
     (1371, 500): 396472.6170924021,
     (1371, 1055): 438478.728674084,
     (1371, 6): 79352464.8247917,
     (1371, 795): 87623.90201385663,
     (1371, 951): 1358091.0639080058,
     (1371, 968): 278907.3733013716,
     (1371, 529): 1126570.9943531912,
     (1371, 720): 613001.0326284129,
     (1371, 643): 85790251.26060152,
     (1371, 1383): 11712733.440043103,
     (1371, 854): 342183.41922263586,
     (1371, 155): 503088.0655666559,
     (1371, 1374): 128953751.45689043,
     (1371, 58): 74834.25723789274,
     (1371, 159): 10271475.707271732,
     (1371, 309): 18881160.413441766,
     (1371, 840): 33522625.447784528,
     (1371, 874): 63186377.47001338,
     (1371, 532): 1048507.5262881257,
     (1371, 709): 1583559740.879915,
     (1371, 450): 4264074.231154555,
     (1371, 447): 2432753.77071647,
     (1371, 1320): 7957932563.990435,
     (1371, 1135): 3929509778.4476337,
     (1371, 913): 3248418251.287472,
     (1371, 1013): 248276737.42100605,
     (1371, 1030): 51979127.01575658,
     (1371, 1096): 13174019.131672677,
     (1371, 440): 153340.24387042073,
     (1371, 248): 367516.48669033573,
     (1371, 1091): 97178122.85669667,
     (1371, 1171): 5258890.189793285,
     (1371, 343): 2993942068.2336497,
     (1371, 1025): 5366527.511425243,
     (1371, 197): 30031389.831369024,
     (1371, 557): 23173007.205108482,
     (1371, 924): 1788711448.4751766,
     (1371, 914): 2660816656.894534,
     (1371, 76): 23915779.60995039,
     (1371, 887): 1488609837.1723065,
     (1371, 1326): 1404457932.7960386,
     (1371, 1328): 1910621192.986327,
     (1371, 200): 1569944837.0520256,
     (1371, 893): 56305203.99100421,
     (1371, 1210): 605270.8881585675,
     (1371, 487): 263661.90550398064,
     (1371, 339): 1591429.644076342,
     (1371, 967): 179311.49105746852,
     (1371, 865): 156737665.15615124,
     (1371, 411): 631498.5577477328,
     (1371, 1331): 274234.8412285354,
     (1371, 97): 141502918.59042874,
     (1371, 1369): 19530539.6345707,
     (1371, 548): 344803.3946401216,
     (1371, 1008): 11373458.52347525,
     (1371, 1071): 142811.31136571342,
     (1371, 990): 398130726.3804601,
     (1371, 960): 148901.91516385,
     (1371, 1042): 55892.52588948683,
     (1371, 1238): 185333.7895494208,
     (1371, 1309): 1782502113.6403432,
     (1371, 1163): 24825676.733893648,
     (1371, 325): 220595.9949694983,
     (1371, 119): 509043.3243246362,
     (1371, 1264): 1310804139.9335375,
     (1371, 1137): 803010074.8486843,
     (1371, 916): 2061804954.3314154,
     (1371, 169): 154653681.67356306,
     (1371, 742): 548596.8682815903,
     (1371, 717): 109932990.56417884,
     (1371, 1078): 18921163.364870574,
     (1371, 354): 24016556036.383984,
     (1371, 1064): 187685.32012019213,
     (1371, 648): 26320010.967628945,
     (1371, 1136): 939499636.7973356,
     (1371, 1318): 1842781696.384357,
     (1371, 75): 674897.3715183215,
     (1371, 1072): 101815.83378993806,
     (1371, 594): 114284.2140871848,
     (1371, 89): 10292107.653754951,
     (1371, 329): 9420258.18271495,
     (1371, 145): 323255.65541910875,
     (1371, 469): 200483677.549832,
     (1371, 814): 278899.74828503176,
     (1371, 542): 1064807.5296781876,
     (1371, 1040): 1009716.5631460644,
     (1371, 43): 2819187.066661055,
     (1371, 538): 1022846.7503564571,
     (1371, 11): 30639035.0388395,
     (1371, 1122): 4249925647.80813,
     (1371, 974): 544976.5370371527,
     (1371, 959): 5190833.013328401,
     (1371, 1021): 61308446.498187296,
     (1371, 721): 705935.0255056919,
     (1371, 1336): 2565358.9769319193,
     (1371, 791): 181458.56401512004,
     (1371, 590): 268198.9414789131,
     (1371, 494): 215773.61314136322,
     (1371, 1262): 69763373.1143633,
     (1371, 1247): 26727935.873963352,
     (1371, 687): 913965.7145839751,
     (1371, 509): 1685624.2273300542,
     (1371, 802): 135525.05659970286,
     (1371, 675): 2852794.006510387,
     (1371, 1216): 816859.8383110524,
     (1371, 465): 37847825.72548584,
     (1371, 502): 460932.61504974496,
     (1371, 515): 72319.03188123762,
     (1371, 1187): 4204749.035212847,
     (1371, 1004): 3048246.0922924126,
     (1371, 804): 893031.2059333503,
     (1371, 46): 1191319.7528737825,
     (1371, 682): 1148297.679892799,
     (1371, 809): 1034452.1035228221,
     (1371, 1127): 305428109.80762756,
     (1371, 962): 4483759.4034866365,
     (1371, 822): 7943151.414403724,
     (1371, 698): 17878924.57699691,
     (1371, 225): 555431390.7967663,
     (1371, 437): 35415178.79841913,
     (1371, 749): 37953.33020266386,
     (1371, 1392): 831684.8577404406,
     (1371, 1365): 4080358.6859548436,
     (1371, 1291): 1489881408.3175924,
     (1371, 1287): 13011723608.32376,
     (1371, 689): 1237835.5906983921,
     (1371, 363): 4536258294.395233,
     (1371, 132): 928766.3864189152,
     (1371, 1197): 39415.76966270575,
     (1371, 118): 1067886.0797715199,
     (1371, 135): 1291940.4605313411,
     (1371, 619): 34025652.81048974,
     (1371, 969): 1653738.7574534002,
     (1371, 400): 828640.0774367602,
     (1371, 573): 56822828.83267398,
     (1371, 1281): 416160172.1341688,
     (1371, 523): 166760.1800274583,
     (1371, 1217): 785812.0449945695,
     (1371, 228): 143145366.05395162,
     (1371, 1157): 1861964.2216159655,
     (1371, 153): 25433439.314856958,
     (1371, 288): 4664790.467931541,
     (1371, 629): 10388795.306734364,
     (1371, 757): 9976973.63423462,
     (1371, 672): 1402580.0197954369,
     (1371, 1340): 111116.1882566273,
     (1371, 1321): 7455042959.972218,
     (1371, 463): 6838614.605530067,
     (1371, 697): 359571764.5766357,
     (1371, 897): 4751615769.952971,
     (1371, 459): 38254093.45334167,
     (1371, 722): 1371561.6726277424,
     (1371, 1382): 568091563.3872005,
     (1371, 320): 1814993.9051181136,
     (1371, 1322): 545756836.2039647,
     (1371, 1224): 29400585.425206445,
     (1371, 375): 39813406.784658544,
     (1371, 1): 132595053.82977828,
     (1371, 1272): 1318876709.8067718,
     (1371, 1117): 327005829.458539,
     (1371, 790): 47042.13660094586,
     (1371, 1152): 1760553.5013854916,
     (1371, 1024): 21148540.449161183,
     (1371, 238): 692926.3711504369,
     (1371, 846): 3695779.5419186275,
     (1371, 569): 134328724.856276,
     (1371, 457): 2144785.8315141965,
     (1371, 202): 125565363.23041731,
     (1371, 444): 58168672.330910355,
     (1371, 313): 8790593.379607355,
     (1371, 149): 419872.60247579974,
     (1371, 1080): 216788144.86006224,
     (1371, 196): 2579599518.051817,
     (1371, 547): 353905.55055866356,
     (1371, 422): 154094.36627701932,
     (1371, 398): 126452.19860413163,
     (1371, 147): 320515.81488069776,
     (1371, 236): 196260.62729124178,
     (1371, 781): 15818879.519320196,
     ...}




```python
target_ids = pd.Series([a[0] for a in results_mse_beetle.keys()]).unique()
target_ids
```




    array([1371, 1345,  423,  646, 1303,  793,  797,  171,  102,  433,  839,
           1079, 1202,  431,  383,  723,  564, 1312,  314,  412, 1121,  642,
            927,  692,  815, 1011,  699,  516,   88,  128,  758,  142,  207,
            961,  855,  586, 1267, 1363, 1294,  605,   48, 1314,  728, 1062,
            539,  359,  345, 1151,  543,   61])




```python
source_ids = pd.Series([a[1] for a in results_mse_beetle.keys()]).unique()
source_ids[0:100]
```




    array([ 261,  287,  249,  377,  426,  505,  475,  410,   91,   20,  903,
            560,  114,  895,  232,  366, 1074, 1254,  297,  623,  613, 1057,
           1167,  768,  876,  551,  160,  387,  950,  406,  748,  834,  766,
            143,  408,  166, 1028, 1288,  628,  407, 1389, 1014, 1367,  844,
            474,  849, 1016, 1209,  522,  227,  358, 1000,  512, 1051,  326,
             26,  976, 1243,  203,  558, 1160, 1052,  508,  312,  983,  663,
           1059,  154,  681,  776, 1230, 1017, 1126,  251,  878, 1347,  603,
             84,  477, 1236,  686,  929,  701,  514, 1112,  655,  293,  453,
           1129, 1394,   31, 1140,   95,  703,  390,  676, 1390,  443, 1037,
           1284])




```python
mse_data = pd.DataFrame({"source_ids" : source_ids})
for tid in target_ids:
    mse_data[str(tid)] = [results_mse_beetle[(tid, sid)] for sid in source_ids]
# mse_data.to_csv("../../../results/raw_data/mse_beetle_results.csv")
mse_data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_ids</th>
      <th>1371</th>
      <th>1345</th>
      <th>423</th>
      <th>646</th>
      <th>1303</th>
      <th>793</th>
      <th>797</th>
      <th>171</th>
      <th>102</th>
      <th>...</th>
      <th>48</th>
      <th>1314</th>
      <th>728</th>
      <th>1062</th>
      <th>539</th>
      <th>359</th>
      <th>345</th>
      <th>1151</th>
      <th>543</th>
      <th>61</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>261</td>
      <td>3.202673e+04</td>
      <td>2.262743e+05</td>
      <td>1.072165e+07</td>
      <td>4.318441e+06</td>
      <td>6.526991e+09</td>
      <td>3.082167e+05</td>
      <td>6.188199e+05</td>
      <td>3.085057e+08</td>
      <td>3.970492e+07</td>
      <td>...</td>
      <td>1.614989e+07</td>
      <td>3.625737e+09</td>
      <td>5.176012e+04</td>
      <td>5.174250e+05</td>
      <td>1.245013e+06</td>
      <td>9.801105e+07</td>
      <td>1.030111e+09</td>
      <td>1.121817e+08</td>
      <td>6.663460e+05</td>
      <td>3.497908e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>287</td>
      <td>3.200505e+05</td>
      <td>9.599532e+05</td>
      <td>1.242343e+07</td>
      <td>6.127276e+06</td>
      <td>6.580498e+09</td>
      <td>8.680487e+05</td>
      <td>3.887977e+05</td>
      <td>3.203447e+08</td>
      <td>4.159576e+07</td>
      <td>...</td>
      <td>1.857686e+07</td>
      <td>3.668429e+09</td>
      <td>4.242752e+05</td>
      <td>8.408055e+05</td>
      <td>7.580978e+05</td>
      <td>1.049041e+08</td>
      <td>1.035491e+09</td>
      <td>1.198932e+08</td>
      <td>1.088139e+06</td>
      <td>2.244201e+05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>249</td>
      <td>1.848357e+05</td>
      <td>8.216849e+05</td>
      <td>1.353607e+07</td>
      <td>6.448925e+06</td>
      <td>6.597675e+09</td>
      <td>7.564058e+05</td>
      <td>1.130988e+05</td>
      <td>3.241879e+08</td>
      <td>4.490556e+07</td>
      <td>...</td>
      <td>1.947765e+07</td>
      <td>3.679374e+09</td>
      <td>3.231118e+05</td>
      <td>1.208609e+06</td>
      <td>4.473185e+05</td>
      <td>1.070320e+08</td>
      <td>1.053315e+09</td>
      <td>1.215788e+08</td>
      <td>1.266719e+06</td>
      <td>3.060931e+04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>377</td>
      <td>1.575376e+07</td>
      <td>1.232790e+07</td>
      <td>2.688073e+06</td>
      <td>3.739861e+06</td>
      <td>5.932545e+09</td>
      <td>1.319532e+07</td>
      <td>2.202944e+07</td>
      <td>1.908584e+08</td>
      <td>1.005446e+07</td>
      <td>...</td>
      <td>3.340026e+06</td>
      <td>3.182949e+09</td>
      <td>1.479766e+07</td>
      <td>1.141033e+07</td>
      <td>2.513985e+07</td>
      <td>3.707783e+07</td>
      <td>8.392269e+08</td>
      <td>4.841957e+07</td>
      <td>1.236765e+07</td>
      <td>2.025369e+07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>426</td>
      <td>1.126752e+05</td>
      <td>5.385922e+05</td>
      <td>1.123770e+07</td>
      <td>5.116559e+06</td>
      <td>6.548042e+09</td>
      <td>5.294205e+05</td>
      <td>4.804214e+05</td>
      <td>3.137778e+08</td>
      <td>4.006631e+07</td>
      <td>...</td>
      <td>1.708838e+07</td>
      <td>3.646864e+09</td>
      <td>1.800589e+05</td>
      <td>5.549259e+05</td>
      <td>9.743204e+05</td>
      <td>1.007897e+08</td>
      <td>1.029250e+09</td>
      <td>1.156306e+08</td>
      <td>7.363353e+05</td>
      <td>2.561176e+05</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>422</td>
      <td>1.540944e+05</td>
      <td>3.308302e+05</td>
      <td>9.652681e+06</td>
      <td>4.185377e+06</td>
      <td>6.508431e+09</td>
      <td>3.752252e+05</td>
      <td>8.626531e+05</td>
      <td>3.051169e+08</td>
      <td>3.715469e+07</td>
      <td>...</td>
      <td>1.526797e+07</td>
      <td>3.617134e+09</td>
      <td>1.415058e+05</td>
      <td>2.816652e+05</td>
      <td>1.503949e+06</td>
      <td>9.615813e+07</td>
      <td>1.017821e+09</td>
      <td>1.105325e+08</td>
      <td>5.931820e+05</td>
      <td>5.336955e+05</td>
    </tr>
    <tr>
      <th>996</th>
      <td>398</td>
      <td>1.264522e+05</td>
      <td>3.210885e+05</td>
      <td>9.741333e+06</td>
      <td>4.286505e+06</td>
      <td>6.509263e+09</td>
      <td>3.044249e+05</td>
      <td>8.164484e+05</td>
      <td>3.054387e+08</td>
      <td>3.722345e+07</td>
      <td>...</td>
      <td>1.524020e+07</td>
      <td>3.617816e+09</td>
      <td>1.090215e+05</td>
      <td>2.896400e+05</td>
      <td>1.485820e+06</td>
      <td>9.635193e+07</td>
      <td>1.019411e+09</td>
      <td>1.105147e+08</td>
      <td>6.024782e+05</td>
      <td>5.116465e+05</td>
    </tr>
    <tr>
      <th>997</th>
      <td>147</td>
      <td>3.205158e+05</td>
      <td>1.138603e+06</td>
      <td>1.470624e+07</td>
      <td>6.759474e+06</td>
      <td>6.618403e+09</td>
      <td>1.184100e+06</td>
      <td>1.726668e+05</td>
      <td>3.287956e+08</td>
      <td>4.634105e+07</td>
      <td>...</td>
      <td>2.101606e+07</td>
      <td>3.693040e+09</td>
      <td>6.010175e+05</td>
      <td>1.444886e+06</td>
      <td>4.069176e+05</td>
      <td>1.085064e+08</td>
      <td>1.052731e+09</td>
      <td>1.247898e+08</td>
      <td>1.149461e+06</td>
      <td>7.865283e+04</td>
    </tr>
    <tr>
      <th>998</th>
      <td>236</td>
      <td>1.962606e+05</td>
      <td>8.484311e+05</td>
      <td>1.347300e+07</td>
      <td>6.449112e+06</td>
      <td>6.597648e+09</td>
      <td>7.812270e+05</td>
      <td>1.155923e+05</td>
      <td>3.242343e+08</td>
      <td>4.456668e+07</td>
      <td>...</td>
      <td>1.945698e+07</td>
      <td>3.680267e+09</td>
      <td>3.331611e+05</td>
      <td>1.158332e+06</td>
      <td>4.399241e+05</td>
      <td>1.070619e+08</td>
      <td>1.051230e+09</td>
      <td>1.216697e+08</td>
      <td>1.264013e+06</td>
      <td>2.708535e+04</td>
    </tr>
    <tr>
      <th>999</th>
      <td>781</td>
      <td>1.581888e+07</td>
      <td>1.351096e+07</td>
      <td>2.449562e+06</td>
      <td>6.788658e+06</td>
      <td>5.992952e+09</td>
      <td>1.365751e+07</td>
      <td>2.081404e+07</td>
      <td>2.086540e+08</td>
      <td>7.060522e+06</td>
      <td>...</td>
      <td>5.246599e+06</td>
      <td>3.265575e+09</td>
      <td>1.461021e+07</td>
      <td>1.028204e+07</td>
      <td>2.356941e+07</td>
      <td>4.800059e+07</td>
      <td>8.290696e+08</td>
      <td>6.042966e+07</td>
      <td>1.254349e+07</td>
      <td>1.924489e+07</td>
    </tr>
  </tbody>
</table>
<p>1000 rows  51 columns</p>
</div>



#### Then, we select the best source, minimizing the sum of MSE, i.e. the bellwhether input video


```python
df = mse_data.set_index('source_ids')
for t in target_ids:
    df[str(t)]=df[str(t)]/np.mean(df[str(t)])
source_ids[np.argmin([np.sum(df.iloc[i]) for i in range(len(source_ids))])]
```




    459



#### The bellwether input is the video with the id # 459!

#### Learning algorithm


```python
LAs = [LinearRegression, DecisionTreeRegressor, RandomForestRegressor, XGBRegressor, SVR]
for i in range(5):
    target_id = np.random.randint(0,1000)
    for la in LAs:
        print(la, beetle.learn(target_id = target_id, train_size=20, learning_algorithm=la))
```

    <class 'sklearn.linear_model._base.LinearRegression'> 7287452.903020396
    <class 'sklearn.tree._classes.DecisionTreeRegressor'> 7908660.494628688
    <class 'sklearn.ensemble._forest.RandomForestRegressor'> 5204935.389192171
    <class 'xgboost.sklearn.XGBRegressor'> 5568924.323390234
    <class 'sklearn.svm._classes.SVR'> 4157672.1707222858
    <class 'sklearn.linear_model._base.LinearRegression'> 7287451.009812243
    <class 'sklearn.tree._classes.DecisionTreeRegressor'> 7577384.640367314
    <class 'sklearn.ensemble._forest.RandomForestRegressor'> 5941277.766099082
    <class 'xgboost.sklearn.XGBRegressor'> 5593892.110586354
    <class 'sklearn.svm._classes.SVR'> 4181079.372169836
    <class 'sklearn.linear_model._base.LinearRegression'> 7287450.8548344625
    <class 'sklearn.tree._classes.DecisionTreeRegressor'> 7601120.123639784
    <class 'sklearn.ensemble._forest.RandomForestRegressor'> 4790747.977584629
    <class 'xgboost.sklearn.XGBRegressor'> 7487327.475946847
    <class 'sklearn.svm._classes.SVR'> 3711599.8254402387
    <class 'sklearn.linear_model._base.LinearRegression'> 7287450.122337452
    <class 'sklearn.tree._classes.DecisionTreeRegressor'> 5685032.268477203
    <class 'sklearn.ensemble._forest.RandomForestRegressor'> 6007698.320591306
    <class 'xgboost.sklearn.XGBRegressor'> 6865681.608605994
    <class 'sklearn.svm._classes.SVR'> 3960656.6615327415
    <class 'sklearn.linear_model._base.LinearRegression'> 7287449.817048368
    <class 'sklearn.tree._classes.DecisionTreeRegressor'> 7274256.16944458
    <class 'sklearn.ensemble._forest.RandomForestRegressor'> 6070271.405390047
    <class 'xgboost.sklearn.XGBRegressor'> 7561261.62099845
    <class 'sklearn.svm._classes.SVR'> 4061101.538045895


#### Chosen algorithm :  SVR (however it may depends on the choice of videos)

But we stick to RF because SVR always returns the same config, very strange result.

We predict the configurations for each video of the test set, for 5 configs, 10 configs, ..., 30 configs in the training set.


```python
beetle_confs = dict()
for i in range(len(index_test)):
    it = index_test[i]
    for ts in train_sizes:
        beetle_confs[(i, ts)] = beetle.predict_conf(target_id = it, train_size=ts,
                                      learning_algorithm = RandomForestRegressor)
```


```python
beetle_confs
```




    {(0, 5): 196,
     (0, 10): 169,
     (0, 15): 195,
     (0, 20): 85,
     (0, 25): 91,
     (0, 30): 91,
     (1, 5): 108,
     (1, 10): 168,
     (1, 15): 62,
     (1, 20): 108,
     (1, 25): 195,
     (1, 30): 169,
     (2, 5): 96,
     (2, 10): 107,
     (2, 15): 101,
     (2, 20): 173,
     (2, 25): 96,
     (2, 30): 169,
     (3, 5): 153,
     (3, 10): 94,
     (3, 15): 96,
     (3, 20): 169,
     (3, 25): 168,
     (3, 30): 173,
     (4, 5): 123,
     (4, 10): 87,
     (4, 15): 91,
     (4, 20): 101,
     (4, 25): 107,
     (4, 30): 200,
     (5, 5): 94,
     (5, 10): 167,
     (5, 15): 91,
     (5, 20): 169,
     (5, 25): 170,
     (5, 30): 168,
     (6, 5): 101,
     (6, 10): 67,
     (6, 15): 24,
     (6, 20): 93,
     (6, 25): 165,
     (6, 30): 168,
     (7, 5): 27,
     (7, 10): 169,
     (7, 15): 100,
     (7, 20): 170,
     (7, 25): 169,
     (7, 30): 168,
     (8, 5): 168,
     (8, 10): 134,
     (8, 15): 102,
     (8, 20): 75,
     (8, 25): 97,
     (8, 30): 189,
     (9, 5): 91,
     (9, 10): 91,
     (9, 15): 93,
     (9, 20): 97,
     (9, 25): 123,
     (9, 30): 169,
     (10, 5): 106,
     (10, 10): 107,
     (10, 15): 101,
     (10, 20): 171,
     (10, 25): 159,
     (10, 30): 169,
     (11, 5): 85,
     (11, 10): 165,
     (11, 15): 159,
     (11, 20): 75,
     (11, 25): 169,
     (11, 30): 168,
     (12, 5): 3,
     (12, 10): 196,
     (12, 15): 165,
     (12, 20): 134,
     (12, 25): 159,
     (12, 30): 93,
     (13, 5): 192,
     (13, 10): 91,
     (13, 15): 102,
     (13, 20): 169,
     (13, 25): 96,
     (13, 30): 169,
     (14, 5): 95,
     (14, 10): 159,
     (14, 15): 17,
     (14, 20): 196,
     (14, 25): 177,
     (14, 30): 94,
     (15, 5): 74,
     (15, 10): 107,
     (15, 15): 192,
     (15, 20): 91,
     (15, 25): 196,
     (15, 30): 94,
     (16, 5): 192,
     (16, 10): 159,
     (16, 15): 102,
     (16, 20): 172,
     (16, 25): 168,
     (16, 30): 165,
     (17, 5): 2,
     (17, 10): 170,
     (17, 15): 173,
     (17, 20): 25,
     (17, 25): 197,
     (17, 30): 159,
     (18, 5): 173,
     (18, 10): 91,
     (18, 15): 195,
     (18, 20): 170,
     (18, 25): 169,
     (18, 30): 177,
     (19, 5): 91,
     (19, 10): 85,
     (19, 15): 159,
     (19, 20): 100,
     (19, 25): 93,
     (19, 30): 168,
     (20, 5): 91,
     (20, 10): 97,
     (20, 15): 91,
     (20, 20): 196,
     (20, 25): 159,
     (20, 30): 96,
     (21, 5): 17,
     (21, 10): 96,
     (21, 15): 87,
     (21, 20): 91,
     (21, 25): 107,
     (21, 30): 168,
     (22, 5): 107,
     (22, 10): 196,
     (22, 15): 172,
     (22, 20): 189,
     (22, 25): 197,
     (22, 30): 91,
     (23, 5): 93,
     (23, 10): 102,
     (23, 15): 192,
     (23, 20): 165,
     (23, 25): 170,
     (23, 30): 123,
     (24, 5): 179,
     (24, 10): 85,
     (24, 15): 105,
     (24, 20): 105,
     (24, 25): 93,
     (24, 30): 159,
     (25, 5): 97,
     (25, 10): 85,
     (25, 15): 171,
     (25, 20): 8,
     (25, 25): 173,
     (25, 30): 195,
     (26, 5): 166,
     (26, 10): 169,
     (26, 15): 85,
     (26, 20): 159,
     (26, 25): 168,
     (26, 30): 169,
     (27, 5): 192,
     (27, 10): 91,
     (27, 15): 97,
     (27, 20): 183,
     (27, 25): 94,
     (27, 30): 159,
     (28, 5): 91,
     (28, 10): 165,
     (28, 15): 91,
     (28, 20): 200,
     (28, 25): 170,
     (28, 30): 159,
     (29, 5): 91,
     (29, 10): 20,
     (29, 15): 74,
     (29, 20): 165,
     (29, 25): 196,
     (29, 30): 165,
     (30, 5): 159,
     (30, 10): 169,
     (30, 15): 97,
     (30, 20): 169,
     (30, 25): 170,
     (30, 30): 177,
     (31, 5): 85,
     (31, 10): 96,
     (31, 15): 169,
     (31, 20): 96,
     (31, 25): 91,
     (31, 30): 168,
     (32, 5): 64,
     (32, 10): 170,
     (32, 15): 134,
     (32, 20): 100,
     (32, 25): 165,
     (32, 30): 169,
     (33, 5): 196,
     (33, 10): 145,
     (33, 15): 25,
     (33, 20): 134,
     (33, 25): 91,
     (33, 30): 75,
     (34, 5): 168,
     (34, 10): 169,
     (34, 15): 189,
     (34, 20): 165,
     (34, 25): 189,
     (34, 30): 85,
     (35, 5): 94,
     (35, 10): 134,
     (35, 15): 166,
     (35, 20): 172,
     (35, 25): 169,
     (35, 30): 168,
     (36, 5): 101,
     (36, 10): 20,
     (36, 15): 172,
     (36, 20): 170,
     (36, 25): 96,
     (36, 30): 170,
     (37, 5): 37,
     (37, 10): 91,
     (37, 15): 200,
     (37, 20): 91,
     (37, 25): 75,
     (37, 30): 173,
     (38, 5): 93,
     (38, 10): 192,
     (38, 15): 106,
     (38, 20): 159,
     (38, 25): 170,
     (38, 30): 159,
     (39, 5): 189,
     (39, 10): 134,
     (39, 15): 74,
     (39, 20): 169,
     (39, 25): 91,
     (39, 30): 172,
     (40, 5): 101,
     (40, 10): 91,
     (40, 15): 159,
     (40, 20): 165,
     (40, 25): 169,
     (40, 30): 177,
     (41, 5): 134,
     (41, 10): 165,
     (41, 15): 169,
     (41, 20): 134,
     (41, 25): 169,
     (41, 30): 91,
     (42, 5): 104,
     (42, 10): 13,
     (42, 15): 93,
     (42, 20): 170,
     (42, 25): 177,
     (42, 30): 168,
     (43, 5): 37,
     (43, 10): 96,
     (43, 15): 159,
     (43, 20): 168,
     (43, 25): 170,
     (43, 30): 168,
     (44, 5): 107,
     (44, 10): 15,
     (44, 15): 170,
     (44, 20): 169,
     (44, 25): 165,
     (44, 30): 159,
     (45, 5): 64,
     (45, 10): 105,
     (45, 15): 67,
     (45, 20): 181,
     (45, 25): 96,
     (45, 30): 177,
     (46, 5): 75,
     (46, 10): 195,
     (46, 15): 159,
     (46, 20): 173,
     (46, 25): 197,
     (46, 30): 196,
     (47, 5): 93,
     (47, 10): 93,
     (47, 15): 94,
     (47, 20): 169,
     (47, 25): 108,
     (47, 30): 169,
     (48, 5): 93,
     (48, 10): 170,
     (48, 15): 62,
     (48, 20): 169,
     (48, 25): 196,
     (48, 30): 100,
     (49, 5): 2,
     (49, 10): 168,
     (49, 15): 102,
     (49, 20): 93,
     (49, 25): 165,
     (49, 30): 91,
     (50, 5): 24,
     (50, 10): 105,
     (50, 15): 85,
     (50, 20): 169,
     (50, 25): 96,
     (50, 30): 165,
     (51, 5): 50,
     (51, 10): 96,
     (51, 15): 168,
     (51, 20): 189,
     (51, 25): 93,
     (51, 30): 170,
     (52, 5): 168,
     (52, 10): 102,
     (52, 15): 97,
     (52, 20): 196,
     (52, 25): 94,
     (52, 30): 172,
     (53, 5): 134,
     (53, 10): 168,
     (53, 15): 173,
     (53, 20): 165,
     (53, 25): 91,
     (53, 30): 85,
     (54, 5): 91,
     (54, 10): 100,
     (54, 15): 75,
     (54, 20): 91,
     (54, 25): 196,
     (54, 30): 123,
     (55, 5): 93,
     (55, 10): 183,
     (55, 15): 76,
     (55, 20): 123,
     (55, 25): 169,
     (55, 30): 196,
     (56, 5): 101,
     (56, 10): 195,
     (56, 15): 195,
     (56, 20): 91,
     (56, 25): 189,
     (56, 30): 170,
     (57, 5): 200,
     (57, 10): 100,
     (57, 15): 168,
     (57, 20): 168,
     (57, 25): 91,
     (57, 30): 159,
     (58, 5): 102,
     (58, 10): 200,
     (58, 15): 177,
     (58, 20): 159,
     (58, 25): 100,
     (58, 30): 165,
     (59, 5): 93,
     (59, 10): 101,
     (59, 15): 85,
     (59, 20): 170,
     (59, 25): 107,
     (59, 30): 165,
     (60, 5): 83,
     (60, 10): 91,
     (60, 15): 195,
     (60, 20): 94,
     (60, 25): 159,
     (60, 30): 101,
     (61, 5): 173,
     (61, 10): 123,
     (61, 15): 173,
     (61, 20): 196,
     (61, 25): 169,
     (61, 30): 134,
     (62, 5): 25,
     (62, 10): 107,
     (62, 15): 75,
     (62, 20): 93,
     (62, 25): 96,
     (62, 30): 169,
     (63, 5): 93,
     (63, 10): 62,
     (63, 15): 165,
     (63, 20): 168,
     (63, 25): 91,
     (63, 30): 96,
     (64, 5): 67,
     (64, 10): 159,
     (64, 15): 17,
     (64, 20): 102,
     (64, 25): 91,
     (64, 30): 165,
     (65, 5): 63,
     (65, 10): 109,
     (65, 15): 195,
     (65, 20): 196,
     (65, 25): 108,
     (65, 30): 159,
     (66, 5): 107,
     (66, 10): 168,
     (66, 15): 97,
     (66, 20): 94,
     (66, 25): 91,
     (66, 30): 91,
     (67, 5): 83,
     (67, 10): 189,
     (67, 15): 177,
     (67, 20): 109,
     (67, 25): 169,
     (67, 30): 165,
     (68, 5): 62,
     (68, 10): 168,
     (68, 15): 101,
     (68, 20): 197,
     (68, 25): 102,
     (68, 30): 91,
     (69, 5): 100,
     (69, 10): 91,
     (69, 15): 96,
     (69, 20): 196,
     (69, 25): 85,
     (69, 30): 197,
     (70, 5): 15,
     (70, 10): 101,
     (70, 15): 169,
     (70, 20): 97,
     (70, 25): 195,
     (70, 30): 159,
     (71, 5): 172,
     (71, 10): 96,
     (71, 15): 85,
     (71, 20): 195,
     (71, 25): 168,
     (71, 30): 195,
     (72, 5): 67,
     (72, 10): 196,
     (72, 15): 96,
     (72, 20): 168,
     (72, 25): 170,
     (72, 30): 168,
     (73, 5): 197,
     (73, 10): 101,
     (73, 15): 109,
     (73, 20): 169,
     (73, 25): 97,
     (73, 30): 134,
     (74, 5): 97,
     (74, 10): 91,
     (74, 15): 91,
     (74, 20): 134,
     (74, 25): 159,
     (74, 30): 196,
     (75, 5): 109,
     (75, 10): 177,
     (75, 15): 85,
     (75, 20): 24,
     (75, 25): 197,
     (75, 30): 172,
     (76, 5): 102,
     (76, 10): 25,
     (76, 15): 96,
     (76, 20): 177,
     (76, 25): 165,
     (76, 30): 177,
     (77, 5): 1,
     (77, 10): 165,
     (77, 15): 97,
     (77, 20): 108,
     (77, 25): 91,
     (77, 30): 197,
     (78, 5): 107,
     (78, 10): 93,
     (78, 15): 170,
     (78, 20): 195,
     (78, 25): 96,
     (78, 30): 159,
     (79, 5): 189,
     (79, 10): 170,
     (79, 15): 177,
     (79, 20): 170,
     (79, 25): 91,
     (79, 30): 170,
     (80, 5): 134,
     (80, 10): 74,
     (80, 15): 15,
     (80, 20): 91,
     (80, 25): 159,
     (80, 30): 123,
     (81, 5): 13,
     (81, 10): 177,
     (81, 15): 169,
     (81, 20): 172,
     (81, 25): 108,
     (81, 30): 170,
     (82, 5): 170,
     (82, 10): 85,
     (82, 15): 169,
     (82, 20): 169,
     (82, 25): 100,
     (82, 30): 168,
     (83, 5): 108,
     (83, 10): 62,
     (83, 15): 102,
     (83, 20): 172,
     (83, 25): 169,
     (83, 30): 170,
     (84, 5): 108,
     (84, 10): 183,
     (84, 15): 172,
     (84, 20): 91,
     (84, 25): 165,
     (84, 30): 168,
     (85, 5): 93,
     (85, 10): 173,
     (85, 15): 85,
     (85, 20): 169,
     (85, 25): 200,
     (85, 30): 165,
     (86, 5): 105,
     (86, 10): 87,
     (86, 15): 108,
     (86, 20): 168,
     (86, 25): 169,
     (86, 30): 93,
     (87, 5): 83,
     (87, 10): 165,
     (87, 15): 91,
     (87, 20): 62,
     (87, 25): 172,
     (87, 30): 91,
     (88, 5): 15,
     (88, 10): 159,
     (88, 15): 196,
     (88, 20): 177,
     (88, 25): 197,
     (88, 30): 177,
     (89, 5): 24,
     (89, 10): 134,
     (89, 15): 166,
     (89, 20): 168,
     (89, 25): 134,
     (89, 30): 196,
     (90, 5): 105,
     (90, 10): 189,
     (90, 15): 100,
     (90, 20): 169,
     (90, 25): 169,
     (90, 30): 159,
     (91, 5): 84,
     (91, 10): 134,
     (91, 15): 169,
     (91, 20): 134,
     (91, 25): 196,
     (91, 30): 165,
     (92, 5): 29,
     (92, 10): 62,
     (92, 15): 170,
     (92, 20): 94,
     (92, 25): 170,
     (92, 30): 102,
     (93, 5): 84,
     (93, 10): 101,
     (93, 15): 102,
     (93, 20): 101,
     (93, 25): 173,
     (93, 30): 159,
     (94, 5): 168,
     (94, 10): 13,
     (94, 15): 62,
     (94, 20): 169,
     (94, 25): 170,
     (94, 30): 123,
     (95, 5): 105,
     (95, 10): 91,
     (95, 15): 96,
     (95, 20): 134,
     (95, 25): 195,
     (95, 30): 100,
     (96, 5): 29,
     (96, 10): 74,
     (96, 15): 91,
     (96, 20): 170,
     (96, 25): 169,
     (96, 30): 170,
     (97, 5): 67,
     (97, 10): 177,
     (97, 15): 177,
     (97, 20): 91,
     (97, 25): 173,
     (97, 30): 173,
     (98, 5): 13,
     (98, 10): 90,
     (98, 15): 169,
     (98, 20): 93,
     (98, 25): 165,
     (98, 30): 169,
     (99, 5): 159,
     (99, 10): 93,
     (99, 15): 15,
     (99, 20): 168,
     (99, 25): 170,
     (99, 30): 170,
     (100, 5): 170,
     (100, 10): 97,
     (100, 15): 169,
     (100, 20): 170,
     (100, 25): 159,
     (100, 30): 123,
     (101, 5): 200,
     (101, 10): 15,
     (101, 15): 168,
     (101, 20): 85,
     (101, 25): 91,
     (101, 30): 170,
     (102, 5): 108,
     (102, 10): 169,
     (102, 15): 91,
     (102, 20): 172,
     (102, 25): 195,
     (102, 30): 107,
     (103, 5): 64,
     (103, 10): 85,
     (103, 15): 93,
     (103, 20): 91,
     (103, 25): 168,
     (103, 30): 195,
     (104, 5): 177,
     (104, 10): 168,
     (104, 15): 169,
     (104, 20): 195,
     (104, 25): 91,
     (104, 30): 91,
     (105, 5): 105,
     (105, 10): 85,
     (105, 15): 169,
     (105, 20): 85,
     (105, 25): 170,
     (105, 30): 169,
     (106, 5): 74,
     (106, 10): 85,
     (106, 15): 159,
     (106, 20): 91,
     (106, 25): 165,
     (106, 30): 91,
     (107, 5): 139,
     (107, 10): 62,
     (107, 15): 107,
     (107, 20): 177,
     (107, 25): 196,
     (107, 30): 85,
     (108, 5): 91,
     (108, 10): 91,
     (108, 15): 101,
     (108, 20): 189,
     (108, 25): 123,
     (108, 30): 170,
     (109, 5): 17,
     (109, 10): 25,
     (109, 15): 102,
     (109, 20): 105,
     (109, 25): 159,
     (109, 30): 91,
     (110, 5): 189,
     (110, 10): 85,
     (110, 15): 177,
     (110, 20): 169,
     (110, 25): 165,
     (110, 30): 169,
     (111, 5): 91,
     (111, 10): 200,
     (111, 15): 15,
     (111, 20): 93,
     (111, 25): 170,
     (111, 30): 170,
     (112, 5): 94,
     (112, 10): 20,
     (112, 15): 165,
     (112, 20): 100,
     (112, 25): 172,
     (112, 30): 196,
     (113, 5): 94,
     (113, 10): 91,
     (113, 15): 177,
     (113, 20): 108,
     (113, 25): 159,
     (113, 30): 168,
     (114, 5): 95,
     (114, 10): 105,
     (114, 15): 169,
     (114, 20): 100,
     (114, 25): 196,
     (114, 30): 168,
     (115, 5): 137,
     (115, 10): 62,
     (115, 15): 169,
     (115, 20): 168,
     (115, 25): 172,
     (115, 30): 134,
     (116, 5): 105,
     (116, 10): 85,
     (116, 15): 197,
     (116, 20): 200,
     (116, 25): 170,
     (116, 30): 91,
     (117, 5): 85,
     (117, 10): 85,
     (117, 15): 134,
     (117, 20): 170,
     (117, 25): 168,
     (117, 30): 168,
     (118, 5): 57,
     (118, 10): 134,
     (118, 15): 177,
     (118, 20): 123,
     (118, 25): 168,
     (118, 30): 177,
     (119, 5): 173,
     (119, 10): 177,
     (119, 15): 109,
     (119, 20): 85,
     (119, 25): 93,
     (119, 30): 169,
     (120, 5): 197,
     (120, 10): 172,
     (120, 15): 169,
     (120, 20): 96,
     (120, 25): 109,
     (120, 30): 91,
     (121, 5): 107,
     (121, 10): 91,
     (121, 15): 159,
     (121, 20): 85,
     (121, 25): 169,
     (121, 30): 173,
     (122, 5): 96,
     (122, 10): 15,
     (122, 15): 170,
     (122, 20): 172,
     (122, 25): 195,
     (122, 30): 91,
     (123, 5): 197,
     (123, 10): 170,
     (123, 15): 197,
     (123, 20): 159,
     (123, 25): 165,
     (123, 30): 168,
     (124, 5): 25,
     (124, 10): 91,
     (124, 15): 169,
     (124, 20): 165,
     (124, 25): 96,
     (124, 30): 170,
     (125, 5): 94,
     (125, 10): 168,
     (125, 15): 165,
     (125, 20): 94,
     (125, 25): 93,
     (125, 30): 91,
     (126, 5): 96,
     (126, 10): 96,
     (126, 15): 85,
     (126, 20): 165,
     (126, 25): 169,
     (126, 30): 109,
     (127, 5): 15,
     (127, 10): 101,
     (127, 15): 85,
     (127, 20): 62,
     (127, 25): 169,
     (127, 30): 170,
     (128, 5): 64,
     (128, 10): 134,
     (128, 15): 91,
     (128, 20): 94,
     (128, 25): 170,
     (128, 30): 165,
     (129, 5): 153,
     (129, 10): 169,
     (129, 15): 170,
     (129, 20): 101,
     (129, 25): 123,
     (129, 30): 165,
     (130, 5): 67,
     (130, 10): 192,
     (130, 15): 85,
     (130, 20): 169,
     (130, 25): 85,
     (130, 30): 165,
     (131, 5): 75,
     (131, 10): 102,
     (131, 15): 172,
     (131, 20): 172,
     (131, 25): 170,
     (131, 30): 91,
     (132, 5): 64,
     (132, 10): 165,
     (132, 15): 107,
     (132, 20): 94,
     (132, 25): 85,
     (132, 30): 197,
     (133, 5): 26,
     (133, 10): 14,
     (133, 15): 170,
     (133, 20): 159,
     (133, 25): 170,
     (133, 30): 197,
     (134, 5): 166,
     (134, 10): 14,
     (134, 15): 94,
     (134, 20): 189,
     (134, 25): 169,
     (134, 30): 166,
     (135, 5): 91,
     (135, 10): 108,
     (135, 15): 17,
     (135, 20): 168,
     (135, 25): 91,
     (135, 30): 169,
     (136, 5): 158,
     (136, 10): 85,
     (136, 15): 83,
     (136, 20): 107,
     (136, 25): 170,
     (136, 30): 159,
     (137, 5): 109,
     (137, 10): 168,
     (137, 15): 102,
     (137, 20): 169,
     (137, 25): 170,
     (137, 30): 168,
     (138, 5): 166,
     (138, 10): 91,
     (138, 15): 107,
     (138, 20): 159,
     (138, 25): 91,
     (138, 30): 177,
     (139, 5): 84,
     (139, 10): 170,
     (139, 15): 197,
     (139, 20): 109,
     (139, 25): 173,
     (139, 30): 168,
     (140, 5): 94,
     (140, 10): 109,
     (140, 15): 134,
     (140, 20): 85,
     (140, 25): 170,
     (140, 30): 172,
     (141, 5): 93,
     (141, 10): 96,
     (141, 15): 94,
     (141, 20): 91,
     (141, 25): 93,
     (141, 30): 168,
     (142, 5): 83,
     (142, 10): 94,
     (142, 15): 107,
     (142, 20): 173,
     (142, 25): 159,
     (142, 30): 168,
     (143, 5): 1,
     (143, 10): 50,
     (143, 15): 91,
     (143, 20): 85,
     (143, 25): 168,
     (143, 30): 91,
     (144, 5): 85,
     (144, 10): 25,
     (144, 15): 189,
     (144, 20): 195,
     (144, 25): 172,
     (144, 30): 196,
     (145, 5): 91,
     (145, 10): 173,
     (145, 15): 189,
     (145, 20): 189,
     (145, 25): 196,
     (145, 30): 169,
     (146, 5): 15,
     (146, 10): 97,
     (146, 15): 91,
     (146, 20): 107,
     (146, 25): 123,
     (146, 30): 91,
     (147, 5): 26,
     (147, 10): 105,
     (147, 15): 18,
     (147, 20): 93,
     (147, 25): 165,
     (147, 30): 195,
     (148, 5): 193,
     (148, 10): 100,
     (148, 15): 196,
     (148, 20): 91,
     (148, 25): 170,
     (148, 30): 170,
     (149, 5): 172,
     (149, 10): 168,
     (149, 15): 172,
     (149, 20): 159,
     (149, 25): 169,
     (149, 30): 91,
     (150, 5): 21,
     (150, 10): 96,
     (150, 15): 67,
     (150, 20): 107,
     (150, 25): 170,
     (150, 30): 159,
     (151, 5): 85,
     (151, 10): 50,
     (151, 15): 105,
     (151, 20): 197,
     (151, 25): 169,
     (151, 30): 159,
     (152, 5): 84,
     (152, 10): 168,
     (152, 15): 169,
     (152, 20): 189,
     (152, 25): 159,
     (152, 30): 165,
     (153, 5): 15,
     (153, 10): 83,
     (153, 15): 196,
     (153, 20): 173,
     (153, 25): 177,
     (153, 30): 91,
     (154, 5): 159,
     (154, 10): 83,
     (154, 15): 170,
     (154, 20): 165,
     (154, 25): 100,
     (154, 30): 169,
     (155, 5): 159,
     (155, 10): 50,
     (155, 15): 168,
     (155, 20): 105,
     (155, 25): 168,
     (155, 30): 169,
     (156, 5): 76,
     (156, 10): 177,
     (156, 15): 29,
     (156, 20): 169,
     (156, 25): 165,
     (156, 30): 91,
     (157, 5): 185,
     (157, 10): 87,
     (157, 15): 168,
     (157, 20): 197,
     (157, 25): 102,
     (157, 30): 168,
     (158, 5): 101,
     (158, 10): 15,
     (158, 15): 134,
     (158, 20): 168,
     (158, 25): 74,
     (158, 30): 159,
     (159, 5): 169,
     (159, 10): 165,
     (159, 15): 170,
     (159, 20): 15,
     (159, 25): 170,
     (159, 30): 159,
     (160, 5): 75,
     (160, 10): 173,
     (160, 15): 177,
     (160, 20): 168,
     (160, 25): 170,
     (160, 30): 159,
     (161, 5): 37,
     (161, 10): 107,
     (161, 15): 170,
     (161, 20): 197,
     (161, 25): 169,
     (161, 30): 134,
     (162, 5): 105,
     (162, 10): 29,
     (162, 15): 91,
     (162, 20): 173,
     (162, 25): 170,
     (162, 30): 91,
     (163, 5): 24,
     (163, 10): 108,
     (163, 15): 170,
     (163, 20): 165,
     (163, 25): 195,
     (163, 30): 91,
     (164, 5): 20,
     (164, 10): 62,
     (164, 15): 101,
     (164, 20): 102,
     (164, 25): 159,
     (164, 30): 91,
     (165, 5): 15,
     (165, 10): 101,
     (165, 15): 197,
     (165, 20): 123,
     (165, 25): 159,
     (165, 30): 168,
     (166, 5): 105,
     (166, 10): 170,
     (166, 15): 29,
     (166, 20): 170,
     ...}




```python
beetle_data = pd.DataFrame({"id_video" : [i for i in range(len(index_test))]})
for ts in train_sizes:
    beetle_data["conf"+str(ts)] = [beetle_confs[(i, ts)] for i in range(len(index_test))]
```


```python
beetle_data.set_index("id_video").to_csv("../../../results/raw_data/Beetle_results.csv")
```


```python

```
